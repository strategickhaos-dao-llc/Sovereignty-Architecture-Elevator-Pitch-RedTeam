# frr.conf â€” Sovereign Swarm v2.0
# FRR OSPF Configuration for Dynamic Mesh Routing (Evolution #10)
# Auto-routes around failures with full-mesh topology
#
# Strategickhaos DAO LLC / Valoryield Engine
# Author: Domenic Garza (Node 137)
#
# Install: apt-get install frr frr-pythontools
# Enable: systemctl enable frr

frr version 8.4
frr defaults traditional
hostname swarm-router
log syslog informational
service integrated-vtysh-config

# Interface configuration
interface wg0
 description Sovereign Swarm WireGuard Mesh
 ip ospf network point-to-multipoint
 ip ospf cost 10
 ip ospf hello-interval 10
 ip ospf dead-interval 40
exit

# Loopback for router ID stability
# NOTE: Replace ${NODE_NUM} with actual node number before deployment:
#   - Command-0: NODE_NUM=1
#   - Fixed-1: NODE_NUM=2
#   - Mobile-2: NODE_NUM=3
# Use: sed -i 's/NODE_NUM/1/g' frr.conf
interface lo
 ip address 10.44.255.${NODE_NUM}/32
exit

# OSPF configuration
router ospf
 ospf router-id 10.44.255.${NODE_NUM}
 
 # Redistribute connected routes
 redistribute connected
 
 # Area 0 - backbone area for all swarm nodes
 network 10.44.0.0/16 area 0
 
 # Passive interface for external interfaces
 passive-interface default
 no passive-interface wg0
 
 # Fast convergence timers
 timers throttle spf 50 100 5000
 
 # Auto-cost reference bandwidth (Gbps)
 auto-cost reference-bandwidth 1000
 
 # Graceful restart for hitless failover
 graceful-restart helper enable
exit

# Route filtering (optional - for multi-area deployments)
ip prefix-list SWARM-INTERNAL seq 10 permit 10.44.0.0/16 le 32
ip prefix-list SWARM-INTERNAL seq 100 deny any

route-map SWARM-FILTER permit 10
 match ip address prefix-list SWARM-INTERNAL
exit

# BFD for fast failure detection (optional)
bfd
 profile swarm-fast
  detect-multiplier 3
  receive-interval 300
  transmit-interval 300
 exit
exit

# Line configuration
line vty
 exec-timeout 60 0
exit
