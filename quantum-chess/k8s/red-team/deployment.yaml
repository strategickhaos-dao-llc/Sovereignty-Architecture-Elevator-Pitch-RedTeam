apiVersion: apps/v1
kind: Deployment
metadata:
  name: red-team-controller
  namespace: red-team
  labels:
    app.kubernetes.io/name: red-team-controller
    app.kubernetes.io/component: controller
    app.kubernetes.io/part-of: quantum-chess
spec:
  replicas: 1
  selector:
    matchLabels:
      app.kubernetes.io/name: red-team-controller
  template:
    metadata:
      labels:
        app.kubernetes.io/name: red-team-controller
        app.kubernetes.io/component: controller
        app.kubernetes.io/part-of: quantum-chess
        team: red
    spec:
      containers:
        - name: controller
          image: kalilinux/kali-rolling:latest
          command: ["/bin/bash", "-c"]
          args:
            - |
              echo "Red Team Controller starting..."
              apt-get update && apt-get install -y nats-tools python3 python3-pip
              pip3 install nats-py
              
              # Main control loop
              while true; do
                echo "[$(date)] Red Team Controller active - coordinating agents"
                sleep 60
              done
          env:
            - name: NATS_URL
              value: "nats://nats.quantum-chess.svc.cluster.local:4222"
            - name: TEAM
              value: "red"
          resources:
            requests:
              memory: "256Mi"
              cpu: "100m"
            limits:
              memory: "512Mi"
              cpu: "500m"
      restartPolicy: Always
---
apiVersion: apps/v1
kind: Deployment
metadata:
  name: port-scanner
  namespace: red-team
  labels:
    app.kubernetes.io/name: port-scanner
    app.kubernetes.io/component: reconnaissance
    app.kubernetes.io/part-of: quantum-chess
spec:
  replicas: 1
  selector:
    matchLabels:
      app.kubernetes.io/name: port-scanner
  template:
    metadata:
      labels:
        app.kubernetes.io/name: port-scanner
        app.kubernetes.io/component: reconnaissance
        app.kubernetes.io/part-of: quantum-chess
        team: red
        capability: network-recon
    spec:
      containers:
        - name: scanner
          image: instrumentisto/nmap:latest
          command: ["/bin/sh", "-c"]
          args:
            - |
              echo "Port Scanner Agent starting..."
              # Run in sandboxed mode - only scan internal targets
              while true; do
                echo "[$(date)] Port Scanner ready for targets"
                sleep 30
              done
          env:
            - name: NATS_URL
              value: "nats://nats.quantum-chess.svc.cluster.local:4222"
            - name: AGENT_TYPE
              value: "port-scanner"
          resources:
            requests:
              memory: "128Mi"
              cpu: "50m"
            limits:
              memory: "256Mi"
              cpu: "200m"
---
apiVersion: apps/v1
kind: Deployment
metadata:
  name: exploit-engine
  namespace: red-team
  labels:
    app.kubernetes.io/name: exploit-engine
    app.kubernetes.io/component: exploitation
    app.kubernetes.io/part-of: quantum-chess
spec:
  replicas: 1
  selector:
    matchLabels:
      app.kubernetes.io/name: exploit-engine
  template:
    metadata:
      labels:
        app.kubernetes.io/name: exploit-engine
        app.kubernetes.io/component: exploitation
        app.kubernetes.io/part-of: quantum-chess
        team: red
        capability: vulnerability-exploitation
    spec:
      containers:
        - name: exploit
          image: kalilinux/kali-rolling:latest
          command: ["/bin/bash", "-c"]
          args:
            - |
              echo "Exploit Engine Agent starting..."
              # Sandboxed exploitation - internal targets only
              while true; do
                echo "[$(date)] Exploit Engine ready"
                sleep 30
              done
          env:
            - name: NATS_URL
              value: "nats://nats.quantum-chess.svc.cluster.local:4222"
            - name: AGENT_TYPE
              value: "exploit-engine"
          resources:
            requests:
              memory: "256Mi"
              cpu: "100m"
            limits:
              memory: "512Mi"
              cpu: "500m"
---
apiVersion: apps/v1
kind: Deployment
metadata:
  name: lateral-movement
  namespace: red-team
  labels:
    app.kubernetes.io/name: lateral-movement
    app.kubernetes.io/component: post-exploitation
    app.kubernetes.io/part-of: quantum-chess
spec:
  replicas: 1
  selector:
    matchLabels:
      app.kubernetes.io/name: lateral-movement
  template:
    metadata:
      labels:
        app.kubernetes.io/name: lateral-movement
        app.kubernetes.io/component: post-exploitation
        app.kubernetes.io/part-of: quantum-chess
        team: red
        capability: internal-pivoting
    spec:
      containers:
        - name: lateral
          image: kalilinux/kali-rolling:latest
          command: ["/bin/bash", "-c"]
          args:
            - |
              echo "Lateral Movement Agent starting..."
              while true; do
                echo "[$(date)] Lateral Movement Agent ready"
                sleep 30
              done
          env:
            - name: NATS_URL
              value: "nats://nats.quantum-chess.svc.cluster.local:4222"
            - name: AGENT_TYPE
              value: "lateral-movement"
          resources:
            requests:
              memory: "256Mi"
              cpu: "100m"
            limits:
              memory: "512Mi"
              cpu: "500m"
