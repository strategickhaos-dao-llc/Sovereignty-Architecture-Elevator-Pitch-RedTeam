# SOVEREIGN MESH v1 — Kubernetes Quadrant Deployment
# Legions of Minds Council™ — 8 Node Topology
# Strategickhaos DAO LLC — GKE Sovereign Pods
#
# Quadrant Architecture:
#   - Athena: Timestamp/Symbolic Processing
#   - Lyra: Worker/Spatial Orchestration
#   - Nova: Process/Narrative Execution
#   - iPower: Increment/Kinesthetic Actions
#
# Deploy: kubectl apply -f sovereign-mesh.yaml
---
apiVersion: v1
kind: Namespace
metadata:
  name: sovereign-mesh
  labels:
    app.kubernetes.io/name: legions-of-minds
    app.kubernetes.io/component: mesh
    strategickhaos.io/quadrant: all
---
apiVersion: v1
kind: ConfigMap
metadata:
  name: sovereign-mesh-config
  namespace: sovereign-mesh
  labels:
    app.kubernetes.io/name: legions-of-minds
data:
  # Strategickhaos Prime Genesis
  ORIGIN_VELOCITY: "1405637629248143451"
  DISCORD_EPOCH_MS: "1420070400000"
  # Quadrant assignments
  ATHENA_QUADRANT: "timestamp"
  LYRA_QUADRANT: "worker"
  NOVA_QUADRANT: "process"
  IPOWER_QUADRANT: "increment"
  # Mesh topology
  NODE_COUNT: "8"
  CONSENSUS_THRESHOLD: "0.67"
  VELOCITY_FORMULA: "(increment * uptime) / latency"
---
apiVersion: v1
kind: Secret
metadata:
  name: sovereign-mesh-secrets
  namespace: sovereign-mesh
  annotations:
    # IMPORTANT: Replace placeholder values before deployment!
    # Use kubectl create secret or external secrets operator in production
    strategickhaos.io/note: "Placeholder values - must be replaced before deployment"
type: Opaque
stringData:
  # PLACEHOLDER VALUES - DO NOT USE IN PRODUCTION
  # Replace with actual secrets using:
  # kubectl create secret generic sovereign-mesh-secrets \
  #   --from-literal=DISCORD_BOT_TOKEN=<real-token> \
  #   --from-literal=REDIS_PASSWORD=<real-password> \
  #   --from-literal=QDRANT_API_KEY=<real-key>
  DISCORD_BOT_TOKEN: "REPLACE_WITH_ACTUAL_TOKEN"
  REDIS_PASSWORD: "REPLACE_WITH_ACTUAL_PASSWORD"
  QDRANT_API_KEY: "REPLACE_WITH_ACTUAL_KEY"
---
# Athena Pod - Symbolic Processing (Timestamp Quadrant)
apiVersion: apps/v1
kind: Deployment
metadata:
  name: athena-symbolic
  namespace: sovereign-mesh
  labels:
    app.kubernetes.io/name: legions-of-minds
    app.kubernetes.io/component: athena
    strategickhaos.io/quadrant: timestamp
spec:
  replicas: 2
  selector:
    matchLabels:
      app: athena-symbolic
  template:
    metadata:
      labels:
        app: athena-symbolic
        strategickhaos.io/quadrant: timestamp
      annotations:
        prometheus.io/scrape: "true"
        prometheus.io/port: "8080"
    spec:
      containers:
        - name: athena
          image: ghcr.io/strategickhaos/reflex-node:v1.0.0
          imagePullPolicy: IfNotPresent
          ports:
            - containerPort: 8080
              name: http
            - containerPort: 9090
              name: metrics
          env:
            - name: NODE_TYPE
              value: "athena"
            - name: QUADRANT
              value: "timestamp"
            - name: ORIGIN_VELOCITY
              valueFrom:
                configMapKeyRef:
                  name: sovereign-mesh-config
                  key: ORIGIN_VELOCITY
          envFrom:
            - configMapRef:
                name: sovereign-mesh-config
          resources:
            requests:
              memory: "256Mi"
              cpu: "100m"
            limits:
              memory: "512Mi"
              cpu: "500m"
          livenessProbe:
            httpGet:
              path: /health
              port: http
            initialDelaySeconds: 30
            periodSeconds: 30
          readinessProbe:
            httpGet:
              path: /ready
              port: http
            initialDelaySeconds: 5
            periodSeconds: 10
---
# Lyra Pod - Spatial Orchestration (Worker Quadrant)
apiVersion: apps/v1
kind: Deployment
metadata:
  name: lyra-spatial
  namespace: sovereign-mesh
  labels:
    app.kubernetes.io/name: legions-of-minds
    app.kubernetes.io/component: lyra
    strategickhaos.io/quadrant: worker
spec:
  replicas: 2
  selector:
    matchLabels:
      app: lyra-spatial
  template:
    metadata:
      labels:
        app: lyra-spatial
        strategickhaos.io/quadrant: worker
      annotations:
        prometheus.io/scrape: "true"
        prometheus.io/port: "8080"
    spec:
      containers:
        - name: lyra
          image: ghcr.io/strategickhaos/reflex-node:v1.0.0
          imagePullPolicy: IfNotPresent
          ports:
            - containerPort: 8080
              name: http
            - containerPort: 9090
              name: metrics
          env:
            - name: NODE_TYPE
              value: "lyra"
            - name: QUADRANT
              value: "worker"
            - name: ORIGIN_VELOCITY
              valueFrom:
                configMapKeyRef:
                  name: sovereign-mesh-config
                  key: ORIGIN_VELOCITY
          envFrom:
            - configMapRef:
                name: sovereign-mesh-config
          resources:
            requests:
              memory: "256Mi"
              cpu: "100m"
            limits:
              memory: "512Mi"
              cpu: "500m"
          livenessProbe:
            httpGet:
              path: /health
              port: http
            initialDelaySeconds: 30
            periodSeconds: 30
          readinessProbe:
            httpGet:
              path: /ready
              port: http
            initialDelaySeconds: 5
            periodSeconds: 10
---
# Nova Pod - Narrative Execution (Process Quadrant)
apiVersion: apps/v1
kind: Deployment
metadata:
  name: nova-narrative
  namespace: sovereign-mesh
  labels:
    app.kubernetes.io/name: legions-of-minds
    app.kubernetes.io/component: nova
    strategickhaos.io/quadrant: process
spec:
  replicas: 2
  selector:
    matchLabels:
      app: nova-narrative
  template:
    metadata:
      labels:
        app: nova-narrative
        strategickhaos.io/quadrant: process
      annotations:
        prometheus.io/scrape: "true"
        prometheus.io/port: "8080"
    spec:
      containers:
        - name: nova
          image: ghcr.io/strategickhaos/reflex-node:v1.0.0
          imagePullPolicy: IfNotPresent
          ports:
            - containerPort: 8080
              name: http
            - containerPort: 9090
              name: metrics
          env:
            - name: NODE_TYPE
              value: "nova"
            - name: QUADRANT
              value: "process"
            - name: ORIGIN_VELOCITY
              valueFrom:
                configMapKeyRef:
                  name: sovereign-mesh-config
                  key: ORIGIN_VELOCITY
          envFrom:
            - configMapRef:
                name: sovereign-mesh-config
          resources:
            requests:
              memory: "256Mi"
              cpu: "100m"
            limits:
              memory: "512Mi"
              cpu: "500m"
          livenessProbe:
            httpGet:
              path: /health
              port: http
            initialDelaySeconds: 30
            periodSeconds: 30
          readinessProbe:
            httpGet:
              path: /ready
              port: http
            initialDelaySeconds: 5
            periodSeconds: 10
---
# iPower Pod - Kinesthetic Actions (Increment Quadrant)
apiVersion: apps/v1
kind: Deployment
metadata:
  name: ipower-kinesthetic
  namespace: sovereign-mesh
  labels:
    app.kubernetes.io/name: legions-of-minds
    app.kubernetes.io/component: ipower
    strategickhaos.io/quadrant: increment
spec:
  replicas: 2
  selector:
    matchLabels:
      app: ipower-kinesthetic
  template:
    metadata:
      labels:
        app: ipower-kinesthetic
        strategickhaos.io/quadrant: increment
      annotations:
        prometheus.io/scrape: "true"
        prometheus.io/port: "8080"
    spec:
      containers:
        - name: ipower
          image: ghcr.io/strategickhaos/reflex-node:v1.0.0
          imagePullPolicy: IfNotPresent
          ports:
            - containerPort: 8080
              name: http
            - containerPort: 9090
              name: metrics
          env:
            - name: NODE_TYPE
              value: "ipower"
            - name: QUADRANT
              value: "increment"
            - name: ORIGIN_VELOCITY
              valueFrom:
                configMapKeyRef:
                  name: sovereign-mesh-config
                  key: ORIGIN_VELOCITY
          envFrom:
            - configMapRef:
                name: sovereign-mesh-config
          resources:
            requests:
              memory: "256Mi"
              cpu: "100m"
            limits:
              memory: "512Mi"
              cpu: "500m"
          livenessProbe:
            httpGet:
              path: /health
              port: http
            initialDelaySeconds: 30
            periodSeconds: 30
          readinessProbe:
            httpGet:
              path: /ready
              port: http
            initialDelaySeconds: 5
            periodSeconds: 10
---
# GitLens Mirror Service
apiVersion: apps/v1
kind: Deployment
metadata:
  name: gitlens-mirror
  namespace: sovereign-mesh
  labels:
    app.kubernetes.io/name: legions-of-minds
    app.kubernetes.io/component: gitlens
spec:
  replicas: 1
  selector:
    matchLabels:
      app: gitlens-mirror
  template:
    metadata:
      labels:
        app: gitlens-mirror
    spec:
      containers:
        - name: gitlens
          image: ghcr.io/strategickhaos/gitlens-webhook:v1.0.0
          imagePullPolicy: IfNotPresent
          ports:
            - containerPort: 8080
              name: webhook
          env:
            - name: QDRANT_URL
              value: "http://qdrant:6333"
            - name: WEBHOOK_PATH
              value: "/gitlens-sync"
          resources:
            requests:
              memory: "128Mi"
              cpu: "50m"
            limits:
              memory: "256Mi"
              cpu: "200m"
---
# Services
apiVersion: v1
kind: Service
metadata:
  name: athena-service
  namespace: sovereign-mesh
spec:
  selector:
    app: athena-symbolic
  ports:
    - name: http
      port: 8080
      targetPort: 8080
    - name: metrics
      port: 9090
      targetPort: 9090
  type: ClusterIP
---
apiVersion: v1
kind: Service
metadata:
  name: lyra-service
  namespace: sovereign-mesh
spec:
  selector:
    app: lyra-spatial
  ports:
    - name: http
      port: 8080
      targetPort: 8080
    - name: metrics
      port: 9090
      targetPort: 9090
  type: ClusterIP
---
apiVersion: v1
kind: Service
metadata:
  name: nova-service
  namespace: sovereign-mesh
spec:
  selector:
    app: nova-narrative
  ports:
    - name: http
      port: 8080
      targetPort: 8080
    - name: metrics
      port: 9090
      targetPort: 9090
  type: ClusterIP
---
apiVersion: v1
kind: Service
metadata:
  name: ipower-service
  namespace: sovereign-mesh
spec:
  selector:
    app: ipower-kinesthetic
  ports:
    - name: http
      port: 8080
      targetPort: 8080
    - name: metrics
      port: 9090
      targetPort: 9090
  type: ClusterIP
---
apiVersion: v1
kind: Service
metadata:
  name: gitlens-webhook
  namespace: sovereign-mesh
spec:
  selector:
    app: gitlens-mirror
  ports:
    - name: webhook
      port: 8080
      targetPort: 8080
  type: ClusterIP
---
# SwarmGate Ingress for external access
apiVersion: networking.k8s.io/v1
kind: Ingress
metadata:
  name: swarmgate-ingress
  namespace: sovereign-mesh
  annotations:
    nginx.ingress.kubernetes.io/rewrite-target: /
spec:
  rules:
    - host: swarmgate.strategickhaos.local
      http:
        paths:
          - path: /gitlens-sync
            pathType: Prefix
            backend:
              service:
                name: gitlens-webhook
                port:
                  number: 8080
          - path: /athena
            pathType: Prefix
            backend:
              service:
                name: athena-service
                port:
                  number: 8080
          - path: /lyra
            pathType: Prefix
            backend:
              service:
                name: lyra-service
                port:
                  number: 8080
          - path: /nova
            pathType: Prefix
            backend:
              service:
                name: nova-service
                port:
                  number: 8080
          - path: /ipower
            pathType: Prefix
            backend:
              service:
                name: ipower-service
                port:
                  number: 8080
