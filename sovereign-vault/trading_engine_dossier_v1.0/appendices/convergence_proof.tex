%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% Convergence Proof - PID-RANCO Controller
%% Strategickhaos Trading Engine v1.0
%% Patent Pending - CONFIDENTIAL
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\section*{Appendix A: Convergence Proof for PID-RANCO Controller}

\subsection*{A.1 Theorem Statement}

\begin{theorem}[PID-RANCO Convergence]
Under Assumptions A1â€“A4, the PID-RANCO control system converges to a neighborhood of the optimal allocation $\mathbf{p}^*$ with probability at least $1 - \delta$ within $T$ time steps, where:
\begin{equation}
T = \mathcal{O}\left(\frac{1}{\lambda_{min}(K_p)} \log\left(\frac{\|\mathbf{e}(0)\|}{\epsilon}\right)\right)
\end{equation}
and $\lambda_{min}(K_p)$ denotes the minimum eigenvalue of the proportional gain matrix $K_p$.
\end{theorem}

\subsection*{A.2 Assumptions}

\begin{enumerate}
\item[\textbf{A1.}] \textbf{Bounded Markets}: Asset prices remain within finite bounds $[p_{min}, p_{max}]$ for all $t$.

\item[\textbf{A2.}] \textbf{Continuous Trading}: The market is open and sufficiently liquid during all operation hours, allowing execution of computed trades within bounded slippage.

\item[\textbf{A3.}] \textbf{Bounded Volatility}: Realized volatility $\sigma(t) < \sigma_{max}$ for some finite $\sigma_{max}$ during all trading periods.

\item[\textbf{A4.}] \textbf{Non-Degenerate Gains}: The proportional gain matrix $K_p$ is positive definite with $\lambda_{min}(K_p) > 0$.
\end{enumerate}

\subsection*{A.3 Proof}

\begin{proof}
We construct a Lyapunov function to establish asymptotic stability of the error dynamics.

\textbf{Step 1: Define Lyapunov Function}

Let $\mathbf{e}(t) = \mathbf{p}^*(t) - \mathbf{p}(t)$ be the tracking error. Define the Lyapunov function:
\begin{equation}
V(\mathbf{e}, \mathbf{e}_I) = \frac{1}{2} \mathbf{e}^T P \mathbf{e} + \frac{1}{2} \mathbf{e}_I^T Q_I \mathbf{e}_I
\end{equation}
where $\mathbf{e}_I = \int_0^t \mathbf{e}(\tau) d\tau$ is the integral error, and $P, Q_I \succ 0$ are positive definite matrices to be determined.

\textbf{Step 2: Error Dynamics}

Under PID control without RANCO constraints, the closed-loop error dynamics are:
\begin{equation}
\dot{\mathbf{e}} = -K_p \mathbf{e} - K_i \mathbf{e}_I - K_d \dot{\mathbf{e}} + \mathbf{d}(t)
\end{equation}
where $\mathbf{d}(t)$ represents disturbances from target allocation changes.

Rearranging for $\dot{\mathbf{e}}$:
\begin{equation}
(I + K_d)\dot{\mathbf{e}} = -K_p \mathbf{e} - K_i \mathbf{e}_I + \mathbf{d}(t)
\end{equation}

Assuming $K_d$ is chosen such that $(I + K_d)$ is invertible:
\begin{equation}
\dot{\mathbf{e}} = -(I + K_d)^{-1}K_p \mathbf{e} - (I + K_d)^{-1}K_i \mathbf{e}_I + (I + K_d)^{-1}\mathbf{d}(t)
\end{equation}

\textbf{Step 3: Time Derivative of Lyapunov Function}

Computing $\dot{V}$ along system trajectories:
\begin{align}
\dot{V} &= \mathbf{e}^T P \dot{\mathbf{e}} + \mathbf{e}_I^T Q_I \mathbf{e} \\
&= -\mathbf{e}^T P (I + K_d)^{-1} K_p \mathbf{e} - \mathbf{e}^T P (I + K_d)^{-1} K_i \mathbf{e}_I \\
&\quad + \mathbf{e}_I^T Q_I \mathbf{e} + \mathbf{e}^T P (I + K_d)^{-1} \mathbf{d}(t)
\end{align}

\textbf{Step 4: Matrix Selection}

Choose $P$ as the solution to the Lyapunov equation:
\begin{equation}
[(I + K_d)^{-1} K_p]^T P + P (I + K_d)^{-1} K_p = Q
\end{equation}
for some $Q \succ 0$.

Choose $Q_I = P (I + K_d)^{-1} K_i$ to cancel cross-terms.

\textbf{Step 5: Stability Analysis}

With proper matrix selection:
\begin{equation}
\dot{V} \leq -\lambda_{min}(Q) \|\mathbf{e}\|^2 + \|P (I + K_d)^{-1}\| \|\mathbf{e}\| \|\mathbf{d}\|
\end{equation}

When $\|\mathbf{d}(t)\|$ is bounded (Assumption A2) and small relative to the control action, we have:
\begin{equation}
\dot{V} \leq -\alpha \|\mathbf{e}\|^2 + \beta \|\mathbf{e}\|
\end{equation}
for some $\alpha, \beta > 0$.

This implies $\dot{V} < 0$ when $\|\mathbf{e}\| > \beta/\alpha$, establishing ultimate boundedness.

\textbf{Step 6: Convergence Rate}

For the undisturbed case ($\mathbf{d} = 0$):
\begin{equation}
\dot{V} \leq -\lambda_{min}(Q) \|\mathbf{e}\|^2 \leq -\frac{\lambda_{min}(Q)}{\lambda_{max}(P)} V
\end{equation}

By Gronwall's inequality:
\begin{equation}
V(t) \leq V(0) \exp\left(-\frac{\lambda_{min}(Q)}{\lambda_{max}(P)} t\right)
\end{equation}

Since $\frac{1}{2}\lambda_{min}(P)\|\mathbf{e}\|^2 \leq V$:
\begin{equation}
\|\mathbf{e}(t)\| \leq \sqrt{\frac{2V(0)}{\lambda_{min}(P)}} \exp\left(-\frac{\lambda_{min}(Q)}{2\lambda_{max}(P)} t\right)
\end{equation}

\textbf{Step 7: Time to Convergence}

Setting $\|\mathbf{e}(T)\| = \epsilon$ and solving for $T$:
\begin{equation}
T = \frac{2\lambda_{max}(P)}{\lambda_{min}(Q)} \log\left(\frac{\sqrt{2V(0)/\lambda_{min}(P)}}{\epsilon}\right)
\end{equation}

Since $Q$ depends linearly on $K_p$ (by construction of the Lyapunov equation), and $V(0) = \mathcal{O}(\|\mathbf{e}(0)\|^2)$:
\begin{equation}
T = \mathcal{O}\left(\frac{1}{\lambda_{min}(K_p)} \log\left(\frac{\|\mathbf{e}(0)\|}{\epsilon}\right)\right)
\end{equation}

\textbf{Step 8: RANCO Projection}

The RANCO optimization projects the PID control signal onto the feasible set defined by constraints. Since projection is non-expansive (i.e., $\|\Pi(x) - \Pi(y)\| \leq \|x - y\|$ for projection $\Pi$), the convergence properties are preserved with the same rate bounds.

The probability statement ($1 - \delta$) accounts for the stochastic nature of market returns, where under bounded volatility (Assumption A3), the disturbance $\mathbf{d}(t)$ remains bounded with high probability.
\end{proof}

\subsection*{A.4 Remarks}

\begin{enumerate}
\item The convergence rate improves with larger $\lambda_{min}(K_p)$, i.e., more aggressive proportional control leads to faster tracking.

\item The derivative gain $K_d$ provides damping, reducing overshoot but potentially slowing convergence.

\item The integral gain $K_i$ ensures zero steady-state error for constant targets but must be tuned to avoid integral windup.

\item In practice, the regime-adaptive gain scheduling ensures appropriate gain selection for current market conditions, maintaining stability across all regimes.
\end{enumerate}
